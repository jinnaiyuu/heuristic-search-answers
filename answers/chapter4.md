# 練習問題4-4、4-5の解答

## 練習問題4-4
**問題**: ヒューリスティック関数h(s)が許容的であるとします。このとき、h'(s) = h(s) + cは許容的でしょうか。cが何を満たせば許容的でしょうか。(cは定数とする)

### 証明

1. h(s)が許容的であるとは：
   - すべての状態sについて h(s) ≤ h*(s)
   - ただし、h*(s)は状態sからゴールまでの実際の最小コスト

2. h'(s)が許容的であるための条件：
   - すべての状態sについて h'(s) ≤ h*(s)

3. h'(s)の式を展開：
   - h'(s) ≤ h*(s)
   - h(s) + c ≤ h*(s)
   - c ≤ h*(s) - h(s)

4. h(s)は許容的なので：
   - h(s) ≤ h*(s)
   - よって、h*(s) - h(s) ≥ 0

5. 結論：
   - c ≤ 0 であれば、h'(s)は許容的
   - なぜなら、c ≤ 0 ≤ h*(s) - h(s) が常に成り立つため

## 練習問題4-5
**問題**: ヒューリスティック関数h(s)が無矛盾であるとします。このとき、h'(s) = h(s) + cは無矛盾でしょうか。cが何を満たせば無矛盾でしょうか。(cは定数とする)

### 証明

1. h(s)が無矛盾であるとは：
   - すべての状態s, s'について
   - h(s) ≤ cost(s, s') + h(s')
   - ただし、cost(s, s')は状態sから状態s'への移動コスト

2. h'(s)が無矛盾であるための条件：
   - h'(s) ≤ cost(s, s') + h'(s')

3. h'(s)の式を展開：
   - h(s) + c ≤ cost(s, s') + (h(s') + c)
   - h(s) + c ≤ cost(s, s') + h(s') + c

4. cの項を消去すると：
   - h(s) ≤ cost(s, s') + h(s')
   - これは元のh(s)の無矛盾性の条件と同じ

5. 結論：
   - 任意の実数cについて、h'(s)は無矛盾
   - なぜなら、不等式の両辺からcが相殺されるため

## 総合的な結論

1. 許容性：c ≤ 0 の場合のみ保証される
2. 無矛盾性：cの値に関係なく常に保持される
3. 実用的な観点：許容性も保証したい場合、cは0以下の値を選ぶ必要がある

## 練習問題4-6
**問題**: 「許容的なヒューリスティックを用いた重み付きA*探索によって発見される解は、最適解のコストf*のw倍以下である」ことを証明してください。

### 証明

1. 前提条件：
   - h(n)は許容的なヒューリスティック関数
   - すべてのノードnについて h(n) ≤ h*(n)
   - 重み付きA*探索の評価関数：f_w(n) = g(n) + w・h(n) ここでw > 1

2. ゴールノードtが展開される時点を考える：
   - オープンリスト上の任意のノードnについて：f_w(t) ≤ f_w(n)
   - f_w(t) = g(t) + w・h(t) = g(t) （ゴールではh(t) = 0）
   - f_w(n) = g(n) + w・h(n)

3. 最適解のパス上にあるノードn*について：
   - g(n*) + h*(n*) = f* （最適解のコスト）
   - h(n*) ≤ h*(n*) （許容性より）
   - f_w(n*) = g(n*) + w・h(n*)
   - f_w(n*) ≤ g(n*) + w・h*(n*)

4. オープンリスト上のn*について：
   - g(t) ≤ g(n*) + w・h(n*) （ゴール展開時の条件より）
   - g(t) ≤ g(n*) + w・h*(n*) （許容性より）
   - g(t) ≤ g(n*) + w(f* - g(n*)) （f*の定義より）
   - g(t) ≤ w・f* - (w-1)g(n*)
   - g(t) ≤ w・f* （g(n*) ≥ 0より）

5. 結論：
   - 重み付きA*探索で見つかった解のコストg(t)は、最適解のコストf*のw倍以下
   - つまり、g(t) ≤ w・f*

### 補足
この証明により、重み付きA*探索は最適解の品質を保証しつつ、探索の効率性を向上させることができることが分かります。wを大きくすると探索は速くなりますが、その分、得られる解の品質は低下する可能性があります。

## 練習問題4-7
**問題**: 強制山登り法が解を見つけることができない可能性がある問題はあるでしょうか。

### 解答
はい、デッドエンドを含む問題では強制山登り法が解を見つけられない可能性があります。

以下のような単純な状態空間を考えます：
```
状態空間：1 -> 2 -> 3
            -> 4 (デッドエンド)

初期状態：1
ゴール状態：3
状態4はデッドエンド（ゴールに到達できない）

各状態のヒューリスティック値：
1: 2.0
2: 1.5
3: 0.0 (ゴール)
4: 0.8 (デッドエンド、状態2よりも良く見える)
```

このとき：

1. 状態1から見て：
   - 状態2の評価値は1.5
   - 状態4の評価値は0.8
   - 強制山登り法は評価値が改善する状態4を選択

2. 状態4は：
   - デッドエンドなので遷移可能な状態がない
   - ゴール（状態3）に到達する経路が存在しない
   - どれだけ深く探索しても改善する状態は見つからない

### 結論
強制山登り法は、より良い評価値を持つデッドエンドが存在する場合、そこに陥ってしまい解を見つけられなくなる可能性があります。これは、一時的に評価値が悪化する経路を考慮できないためです。
